{% extends "base.html" %}
{% block title %}Well Done! â€“ Ritu's ReadAlong Tutor{% endblock %}

{% block content %}
<style>
    /* Confetti animation */
    .confetti-container {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        z-index: 50;
        overflow: hidden;
    }
    .confetti {
        position: absolute;
        top: -20px;
        width: 12px;
        height: 12px;
        border-radius: 2px;
        animation: confetti-fall linear forwards;
    }
    @keyframes confetti-fall {
        0%   { transform: translateY(0) rotate(0deg) scale(1); opacity: 1; }
        80%  { opacity: 1; }
        100% { transform: translateY(105vh) rotate(720deg) scale(0.5); opacity: 0; }
    }
    .star-burst {
        animation: star-burst 0.8s ease-out forwards;
    }
    @keyframes star-burst {
        0%   { transform: scale(0) rotate(-20deg); opacity: 0; }
        50%  { transform: scale(1.3) rotate(5deg); opacity: 1; }
        100% { transform: scale(1) rotate(0deg); opacity: 1; }
    }
    .slide-up {
        animation: slide-up 0.6s ease-out forwards;
        opacity: 0;
    }
    @keyframes slide-up {
        0%   { transform: translateY(30px); opacity: 0; }
        100% { transform: translateY(0); opacity: 1; }
    }
</style>

<!-- Confetti -->
<div class="confetti-container" x-data x-init="
    const colors = ['#f59e0b','#10b981','#3b82f6','#ef4444','#8b5cf6','#ec4899','#06b6d4','#f97316'];
    const container = $el;
    for (let i = 0; i < 80; i++) {
        const el = document.createElement('div');
        el.className = 'confetti';
        el.style.left = Math.random() * 100 + '%';
        el.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
        el.style.animationDuration = (2.5 + Math.random() * 2) + 's';
        el.style.animationDelay = (Math.random() * 1.5) + 's';
        el.style.width = (8 + Math.random() * 10) + 'px';
        el.style.height = (8 + Math.random() * 10) + 'px';
        el.style.borderRadius = Math.random() > 0.5 ? '50%' : '2px';
        container.appendChild(el);
    }
    setTimeout(() => container.remove(), 6000);
"></div>

<div class="max-w-2xl mx-auto py-6 sm:py-12 text-center">

    <!-- Star emoji with burst animation -->
    <div class="star-burst inline-block mb-4" style="animation-delay: 0.3s;">
        <span class="text-7xl sm:text-8xl block">ðŸŒŸ</span>
    </div>

    <!-- Main message -->
    <div class="slide-up" style="animation-delay: 0.6s;">
        <h1 class="font-display text-3xl sm:text-5xl font-bold text-gray-900 mb-3">
            Well Done!
        </h1>
        <p class="text-lg sm:text-xl text-gray-600 font-medium mb-2">
            You read <span class="text-primary-600 font-bold">"{{ story.title }}"</span>
        </p>
        <p class="text-base sm:text-lg text-gray-500">
            {{ summary.encouragement if summary and summary.encouragement else "You did a wonderful job reading today!" }}
        </p>
    </div>

    <!-- Celebration card -->
    <div class="slide-up mt-8 sm:mt-10" style="animation-delay: 1s;">
        <div class="bg-white rounded-3xl shadow-xl p-6 sm:p-10 border-2 border-amber-200 inline-block w-full max-w-md mx-auto">
            <div class="text-5xl mb-4">ðŸ“–</div>
            <p class="font-display text-xl sm:text-2xl font-bold text-gray-800 mb-2">
                Story Complete!
            </p>
            <p class="text-gray-500 text-sm sm:text-base">
                Every story you read makes you a better reader.
                <br>Keep up the great work!
            </p>

            {% if attempt.wpm_estimate and attempt.wpm_estimate > 0 %}
            <div class="mt-5 pt-5 border-t border-gray-100">
                <p class="text-sm text-gray-400 font-medium">Reading Speed</p>
                <p class="text-2xl font-bold text-accent-600 mt-1">
                    {{ "%.0f"|format(attempt.wpm_estimate) }}
                    <span class="text-sm font-normal text-gray-400">words/min</span>
                </p>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Actions -->
    <div class="slide-up flex flex-col sm:flex-row gap-4 justify-center mt-8 sm:mt-10" style="animation-delay: 1.4s;">
        <a href="/stories/{{ story.id }}"
           class="px-6 py-3 bg-accent-500 text-white rounded-xl font-bold text-center hover:bg-accent-600 transition-colors shadow-lg">
            ðŸ”„ Read Again
        </a>
        <a href="/"
           class="px-6 py-3 bg-primary-500 text-white rounded-xl font-bold text-center hover:bg-primary-600 transition-colors shadow-lg">
            ðŸ“š Try Another Story
        </a>
    </div>
</div>
{% endblock %}
